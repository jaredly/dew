# vim: set syntax=sh:
SetContainerImage "sameersbn/postgresql:latest"

ContainerExists "postgresql" || {
  sudo docker start postgresql
    AnnounceVolume "data" "/opt/postgresql/data" "/var/lib/postgresql"
    sudo docker run --name postgresql -d \
      -v /opt/postgresql/data:/var/lib/postgresql $IMAGE
    sleep 5 # TODO Wait for it to startup, do this via a loop though
    PG_IP=$(sudo docker inspect postgresql | grep IPAddres | awk -F'"' '{print $4}')
    sudo docker logs postgresql > $SCOPE/info
    echo "Connect with psql -U postgres -h $PG_IP" >> $SCOPE/info
  }
}

cat $SCOPE/info
echo_green "Ready"
